
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WeatherAI Dashboard</title>
    <style>
        :root {
            --primary: #4361ee;
            --secondary: #3a0ca3;
            --accent: #4895ef;
            --danger: #f72585;
            --warning: #f8961e;
            --success: #4cc9f0;
            --safe: #4caf50;
            --dark: #212529;
            --light: #f8f9fa;
            --card-bg: #ffffff;
            --sidebar-bg: linear-gradient(135deg, #3a0ca3, #4361ee);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: #f5f7fa;
            color: var(--dark);
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: var(--sidebar-bg);
            color: white;
            padding: 20px 0;
            height: 100vh;
            position: sticky;
            top: 0;
            transition: all 0.3s;
            box-shadow: 2px 0 15px rgba(0,0,0,0.1);
        }

        .sidebar-collapsed {
            width: 80px;
        }

        .logo {
            text-align: center;
            padding: 20px 10px;
            font-size: 22px;
            font-weight: 600;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .logo-collapsed span {
            display: none;
        }

        .nav-menu {
            list-style: none;
            padding: 0 15px;
        }

        .nav-item {
            padding: 12px 15px;
            margin-bottom: 5px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            white-space: nowrap;
        }

        .nav-item:hover {
            background-color: rgba(255,255,255,0.15);
        }

        .nav-item.active {
            background-color: rgba(255,255,255,0.25);
        }

        .nav-item i {
            font-size: 20px;
            min-width: 24px;
            text-align: center;
        }

        .nav-text {
            transition: opacity 0.3s;
        }

        .sidebar-collapsed .nav-text {
            opacity: 0;
            width: 0;
            overflow: hidden;
        }

        .toggle-sidebar {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-sidebar:hover {
            background: rgba(255,255,255,0.3);
        }

        /* Main Content */
        .main-content {
            flex: 1;
            padding: 30px;
            transition: margin-left 0.3s;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 600;
            color: var(--primary);
        }

        .user-area {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            padding: 10px 15px 10px 40px;
            border-radius: 30px;
            border: 1px solid #ddd;
            width: 250px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(72, 149, 239, 0.2);
        }

        .search-box i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #777;
        }

        .user-profile {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--accent);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        /* Dashboard Grid */
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }

        /* Cards */
        .card {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary);
        }

        .card-icon {
            width: 44px;
            height: 44px;
            border-radius: 10px;
            background-color: rgba(67, 97, 238, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 20px;
        }

        /* Weather Card */
        .weather-card {
            grid-column: span 2;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .current-weather {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .weather-icon {
            width: 120px;
            height: 120px;
            margin-bottom: 10px;
        }

        .temperature {
            font-size: 48px;
            font-weight: 600;
            margin: 10px 0;
            color: var(--dark);
        }

        .weather-desc {
            font-size: 18px;
            color: #555;
            text-transform: capitalize;
        }

        .weather-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .detail-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background-color: rgba(248, 249, 250, 0.8);
            border-radius: 8px;
        }

        .detail-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: rgba(67, 97, 238, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
        }

        .detail-text {
            display: flex;
            flex-direction: column;
        }

        .detail-label {
            font-size: 12px;
            color: #777;
        }

        .detail-value {
            font-size: 16px;
            font-weight: 500;
        }

        /* AQI Card */
        .aqi-value {
            font-size: 42px;
            font-weight: 700;
            margin: 15px 0;
            text-align: center;
        }

        .aqi-status {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            text-align: center;
            display: inline-block;
            margin: 0 auto;
            color: white;
        }

        /* Emergency Contacts Card */
        .emergency-contacts {
            grid-column: span 1;
        }

        .contact-list {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 15px;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            background-color: rgba(248, 249, 250, 0.8);
            border-radius: 8px;
            transition: all 0.2s;
        }

        .contact-item:hover {
            background-color: rgba(67, 97, 238, 0.1);
        }

        .contact-icon {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: rgba(244, 67, 54, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #f44336;
        }

        .contact-number {
            font-weight: 600;
            color: var(--primary);
            cursor: pointer;
        }

        .contact-label {
            font-size: 12px;
            color: #666;
        }

        /* Forecast */
        .forecast-container {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding: 15px 5px;
        }

        .forecast-item {
            min-width: 120px;
            padding: 15px;
            background-color: rgba(248, 249, 250, 0.8);
            border-radius: 10px;
            text-align: center;
            transition: transform 0.3s;
        }

        .forecast-item:hover {
            transform: scale(1.05);
        }

        .forecast-day {
            font-weight: 600;
            margin-bottom: 8px;
        }

        .forecast-icon {
            width: 50px;
            height: 50px;
            margin: 5px auto;
        }

        .forecast-temp {
            font-weight: 500;
        }

        /* Map Card */
        .map-card {
            grid-column: span 2;
        }

        #map {
            height: 400px;
            border-radius: 10px;
            margin-top: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .zone-legend {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 12px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .legend-safe {
            background-color: var(--safe);
        }

        .legend-warning {
            background-color: var(--warning);
        }

        .legend-danger {
            background-color: var(--danger);
        }

        /* Alert Card */
        .alert-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            background-color: rgba(248, 249, 250, 0.8);
        }

        .alert-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 18px;
        }

        .alert-danger {
            background-color: var(--danger);
        }

        .alert-warning {
            background-color: var(--warning);
        }

        .alert-info {
            background-color: var(--accent);
        }

        .alert-content {
            flex: 1;
        }

        .alert-title {
            font-weight: 500;
            margin-bottom: 3px;
        }

        .alert-desc {
            font-size: 13px;
            color: #666;
        }

        /* Weather Gallery */
        .weather-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .gallery-item {
            border-radius: 8px;
            overflow: hidden;
            height: 100px;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .gallery-item:hover {
            transform: scale(1.05);
        }

        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Chatbot Button */
        .chatbot-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(67, 97, 238, 0.3);
            z-index: 100;
            transition: all 0.3s;
        }

        .chatbot-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(67, 97, 238, 0.4);
        }

        .chatbot-btn i {
            font-size: 24px;
        }

        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--danger);
            color: white;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: white;
            border-radius: 15px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
            animation: modalFadeIn 0.3s ease-out;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .close-modal {
            position: absolute;
            top: 15px;
            right: 15px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background-color: rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            z-index: 10;
        }

        .close-modal:hover {
            background-color: rgba(0,0,0,0.2);
        }

        /* Chatbot Styles */
        #chatbot-container {
            display: flex;
            flex-direction: column;
            height: 600px;
            background-color: white;
        }

        #chatbot-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #chatbot-title {
            font-weight: 600;
            font-size: 18px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #chatbot-title::before {
            content: "";
            display: inline-block;
            width: 8px;
            height: 8px;
            background-color: #4caf50;
            border-radius: 50%;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        #minimize-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 20px;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
        }

        #minimize-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        #language-selector {
            padding: 10px 15px;
            background-color: #f5f7fa;
            display: flex;
            gap: 10px;
            overflow-x: auto;
        }

        .language-btn {
            background: white;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 5px 15px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .language-btn:hover {
            background: #f5f5f5;
        }

        .language-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        #chat-area {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background-color: #f5f7fa;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .message {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: 18px;
            line-height: 1.4;
            word-wrap: break-word;
            font-size: 14px;
            box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
            animation: fadeIn 0.3s ease;
            position: relative;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .user-message {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }

        .bot-message {
            background-color: white;
            color: var(--dark);
            margin-right: auto;
            border-bottom-left-radius: 4px;
            border: 1px solid #e0e0e0;
        }

        .message-time {
            font-size: 10px;
            color: rgba(255,255,255,0.7);
            margin-top: 4px;
            text-align: right;
        }

        .bot-message .message-time {
            color: #999;
        }

        .typing-indicator {
            display: flex;
            padding: 12px 16px;
            background-color: white;
            border-radius: 18px;
            margin-right: auto;
            border-bottom-left-radius: 4px;
            width: fit-content;
            border: 1px solid #e0e0e0;
            align-items: center;
            gap: 8px;
        }

        .typing-text {
            font-size: 13px;
            color: #666;
        }

        .typing-dot {
            width: 8px;
            height: 8px;
            background-color: #666;
            border-radius: 50%;
            animation: typingAnimation 1.4s infinite ease-in-out;
        }

        .typing-dot:nth-child(1) {
            animation-delay: 0s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }

        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes typingAnimation {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-3px); }
        }

        #input-area {
            display: flex;
            padding: 15px;
            border-top: 1px solid #e0e0e0;
            background-color: white;
            gap: 10px;
        }

        #user-input {
            flex: 1;
            padding: 12px 18px;
            border: 1px solid #e0e0e0;
            border-radius: 25px;
            outline: none;
            font-size: 14px;
            transition: border 0.2s;
        }

        #user-input:focus {
            border-color: var(--accent);
        }

        #send-btn {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            border: none;
            border-radius: 25px;
            padding: 0 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s, opacity 0.2s;
        }

        #send-btn:hover {
            opacity: 0.9;
        }

        #send-btn:active {
            transform: scale(0.95);
        }

        #send-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
        }

        /* Settings Modal */
        .settings-modal {
            max-width: 500px;
            padding: 30px;
        }

        .settings-title {
            font-size: 22px;
            font-weight: 600;
            margin-bottom: 20px;
            color: var(--primary);
            text-align: center;
        }

        .settings-group {
            margin-bottom: 25px;
        }

        .settings-group-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .settings-group-title i {
            color: var(--primary);
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .setting-label {
            font-size: 14px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--primary);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .select-wrapper {
            position: relative;
            width: 120px;
        }

        .select-wrapper select {
            width: 100%;
            padding: 8px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            appearance: none;
            background-color: white;
            font-size: 14px;
        }

        .select-wrapper::after {
            content: "▼";
            font-size: 10px;
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            pointer-events: none;
            color: #777;
        }

        /* Responsive */
        @media (max-width: 1200px) {
            .weather-card {
                grid-column: span 1;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                position: fixed;
                left: -280px;
                z-index: 1000;
            }
            .sidebar.active {
                left: 0;
            }
            .main-content {
                margin-left: 0;
            }
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            .weather-details {
                grid-template-columns: 1fr;
            }
            .contact-list {
                grid-template-columns: 1fr;
            }
            .search-box input {
                width: 200px;
            }
        }

        @media (max-width: 576px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            .user-area {
                width: 100%;
                justify-content: space-between;
            }
            .search-box input {
                width: 180px;
            }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <!-- Sidebar -->
    <div class="sidebar" id="sidebar">
        <div class="logo">
            <i class="fas fa-cloud-sun"></i>
            <span>WeatherAI</span>
        </div>
        <ul class="nav-menu">
            <li class="nav-item active" data-page="dashboard">
                <i class="fas fa-home"></i>
                <span class="nav-text">Dashboard</span>
            </li>
            <li class="nav-item" data-page="weather">
                <i class="fas fa-cloud-sun-rain"></i>
                <span class="nav-text">Weather</span>
            </li>
            <li class="nav-item" data-page="forecast">
                <i class="fas fa-calendar-alt"></i>
                <span class="nav-text">Forecast</span>
            </li>
            <li class="nav-item" data-page="alerts">
                <i class="fas fa-exclamation-triangle"></i>
                <span class="nav-text">Alerts</span>
            </li>
            <li class="nav-item" data-page="maps">
                <i class="fas fa-map-marked-alt"></i>
                <span class="nav-text">Maps</span>
            </li>
            <li class="nav-item" data-page="assistant">
                <i class="fas fa-robot"></i>
                <span class="nav-text">AI Assistant</span>
            </li>
            <li class="nav-item" data-page="settings">
                <i class="fas fa-cog"></i>
                <span class="nav-text">Settings</span>
            </li>
        </ul>
        <button class="toggle-sidebar" id="toggle-sidebar">
            <i class="fas fa-chevron-left"></i>
        </button>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="main-content">
        <div class="header">
            <div class="page-title">Dashboard</div>
            <div class="user-area">
                <div class="search-box">
                    <i class="fas fa-search"></i>
                    <input type="text" placeholder="Search location...">
                </div>
                <div class="user-profile">
                    <div class="user-avatar">JD</div>
                    <span>John Doe</span>
                </div>
            </div>
        </div>

        <!-- Dashboard Grid -->
        <div class="dashboard-grid">
            <!-- Weather Card -->
            <div class="card weather-card">
                <div class="card-header">
                    <div class="card-title">Current Weather</div>
                    <div class="card-icon">
                        <i class="fas fa-cloud-sun"></i>
                    </div>
                </div>
                <div class="current-weather">
                    <img src="https://openweathermap.org/img/wn/01d@2x.png" alt="Weather Icon" class="weather-icon" id="weather-icon">
                    <div class="temperature" id="temperature">--°C</div>
                    <div class="weather-desc" id="weather-desc">--</div>
                </div>
                <div class="weather-details">
                    <div class="detail-item">
                        <div class="detail-icon">
                            <i class="fas fa-temperature-high"></i>
                        </div>
                        <div class="detail-text">
                            <span class="detail-label">Feels Like</span>
                            <span class="detail-value" id="feels-like">--°C</span>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">
                            <i class="fas fa-tint"></i>
                        </div>
                        <div class="detail-text">
                            <span class="detail-label">Humidity</span>
                            <span class="detail-value" id="humidity">--%</span>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">
                            <i class="fas fa-wind"></i>
                        </div>
                        <div class="detail-text">
                            <span class="detail-label">Wind</span>
                            <span class="detail-value" id="wind-speed">-- km/h</span>
                        </div>
                    </div>
                    <div class="detail-item">
                        <div class="detail-icon">
                            <i class="fas fa-compress-alt"></i>
                        </div>
                        <div class="detail-text">
                            <span class="detail-label">Pressure</span>
                            <span class="detail-value" id="pressure">-- hPa</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- AQI Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Air Quality</div>
                    <div class="card-icon">
                        <i class="fas fa-wind"></i>
                    </div>
                </div>
                <div class="aqi-value" id="aqi-value">--</div>
                <div class="aqi-status" id="aqi-status">Status: --</div>
            </div>

            <!-- Emergency Contacts Card -->
            <div class="card emergency-contacts">
                <div class="card-header">
                    <div class="card-title">Emergency Contacts (India)</div>
                    <div class="card-icon">
                        <i class="fas fa-phone-alt"></i>
                    </div>
                </div>
                <div class="contact-list">
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-ambulance"></i>
                        </div>
                        <div class="contact-text">
                            <div class="contact-number">108 / 102</div>
                            <div class="contact-label">Ambulance</div>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-fire-extinguisher"></i>
                        </div>
                        <div class="contact-text">
                            <div class="contact-number">101</div>
                            <div class="contact-label">Fire Brigade</div>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-hospital"></i>
                        </div>
                        <div class="contact-text">
                            <div class="contact-number">104</div>
                            <div class="contact-label">Health Helpline</div>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="contact-text">
                            <div class="contact-number">112</div>
                            <div class="contact-label">National Emergency</div>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-women"></i>
                        </div>
                        <div class="contact-text">
                            <div class="contact-number">1091</div>
                            <div class="contact-label">Women Helpline</div>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i class="fas fa-child"></i>
                        </div>
                        <div class="contact-text">
                            <div class="contact-number">1098</div>
                            <div class="contact-label">Child Helpline</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Weather Gallery Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Weather Gallery</div>
                    <div class="card-icon">
                        <i class="fas fa-images"></i>
                    </div>
                </div>
                <div class="weather-gallery">
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1561484930-974554019ade?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Sunny">
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1534274988757-a28bf1a57c17?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Rainy">
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1515694346937-94d85e41e6f0?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Cloudy">
                    </div>
                    <div class="gallery-item">
                        <img src="https://images.unsplash.com/photo-1483728642387-6c3bdd6c93e5?ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=80" alt="Storm">
                    </div>
                </div>
            </div>

            <!-- Alerts Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">Weather Alerts</div>
                    <div class="card-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                </div>
                <div id="alerts-container">
                    <div class="alert-item">
                        <div class="alert-icon alert-warning">
                            <i class="fas fa-temperature-high"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">Heatwave Warning</div>
                            <div class="alert-desc">High temperatures expected tomorrow</div>
                        </div>
                    </div>
                    <div class="alert-item">
                        <div class="alert-icon alert-info">
                            <i class="fas fa-umbrella"></i>
                        </div>
                        <div class="alert-content">
                            <div class="alert-title">Rain Advisory</div>
                            <div class="alert-desc">Possible showers this weekend</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Forecast Card -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">3-Day Forecast</div>
                    <div class="card-icon">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                </div>
                <div class="forecast-container" id="forecast-container">
                    <!-- Forecast items will be added here -->
                </div>
            </div>

            <!-- Map Card -->
            <div class="card map-card">
                <div class="card-header">
                    <div class="card-title">Weather Map</div>
                    <div class="card-icon">
                        <i class="fas fa-map-marked-alt"></i>
                    </div>
                </div>
                <div id="map"></div>
                <div class="zone-legend">
                    <div class="legend-item">
                        <div class="legend-color legend-safe"></div>
                        <span>Safe Zone</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-warning"></div>
                        <span>Warning Zone</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color legend-danger"></div>
                        <span>Danger Zone</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Menu Toggle -->
    <div class="mobile-menu-toggle" id="mobile-menu-toggle">
        <i class="fas fa-bars"></i>
    </div>

    <!-- Chatbot Button -->
    <button class="chatbot-btn" id="chatbot-toggle">
        <i class="fas fa-comment-dots"></i>
        <span class="notification-badge">3</span>
    </button>

    <!-- AI Assistant Modal -->
    <div class="modal" id="assistant-modal">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <div id="chatbot-container">
                <div id="chatbot-header">
                    <div id="chatbot-title">Multilingual AI Assistant</div>
                    <button id="minimize-btn">−</button>
                </div>
                <div id="language-selector">
                    <button class="language-btn active" data-lang="en">English</button>
                    <button class="language-btn" data-lang="hi">हिंदी</button>
                    <button class="language-btn" data-lang="mr">मराठी</button>
                    <button class="language-btn" data-lang="ta">தமிழ்</button>
                    <button class="language-btn" data-lang="te">తెలుగు</button>
                </div>
                <div id="chat-area"></div>
                <div id="input-area">
                    <input type="text" id="user-input" placeholder="Type your message..." autocomplete="off">
                    <button id="send-btn">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal">
        <div class="modal-content settings-modal">
            <span class="close-modal">&times;</span>
            <div class="settings-title">
                <i class="fas fa-cog"></i> Settings
            </div>
            
            <div class="settings-group">
                <div class="settings-group-title">
                    <i class="fas fa-paint-brush"></i> Appearance
                </div>
                <div class="setting-item">
                    <div class="setting-label">Dark Mode</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="dark-mode-toggle">
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Theme Color</div>
                    <div class="select-wrapper">
                        <select id="theme-color">
                            <option value="blue">Blue</option>
                            <option value="green">Green</option>
                            <option value="purple">Purple</option>
                            <option value="red">Red</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="settings-group">
                <div class="settings-group-title">
                    <i class="fas fa-bell"></i> Notifications
                </div>
                <div class="setting-item">
                    <div class="setting-label">Weather Alerts</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="weather-alerts-toggle" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Emergency Alerts</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="emergency-alerts-toggle" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
            
            <div class="settings-group">
                <div class="settings-group-title">
                    <i class="fas fa-temperature-low"></i> Weather Units
                </div>
                <div class="setting-item">
                    <div class="setting-label">Temperature</div>
                    <div class="select-wrapper">
                        <select id="temperature-unit">
                            <option value="celsius">Celsius (°C)</option>
                            <option value="fahrenheit">Fahrenheit (°F)</option>
                        </select>
                    </div>
                </div>
                <div class="setting-item">
                    <div class="setting-label">Wind Speed</div>
                    <div class="select-wrapper">
                        <select id="wind-speed-unit">
                            <option value="kmh">km/h</option>
                            <option value="mph">mph</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="settings-group">
                <div class="settings-group-title">
                    <i class="fas fa-language"></i> Language
                </div>
                <div class="setting-item">
                    <div class="setting-label">App Language</div>
                    <div class="select-wrapper">
                        <select id="app-language">
                            <option value="en">English</option>
                            <option value="hi">हिंदी (Hindi)</option>
                            <option value="mr">मराठी (Marathi)</option>
                            <option value="ta">தமிழ் (Tamil)</option>
                            <option value="te">తెలుగు (Telugu)</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="settings-group">
                <div class="settings-group-title">
                    <i class="fas fa-phone-alt"></i> Emergency Contacts
                </div>
                <div class="setting-item">
                    <div class="setting-label">Show Emergency Section</div>
                    <label class="toggle-switch">
                        <input type="checkbox" id="emergency-section-toggle" checked>
                        <span class="toggle-slider"></span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-routing-machine@3.2.12/dist/leaflet-routing-machine.min.js"></script>
    <script>
        // Global variables
        const apikey = "enter your api key"; // Replace with your OpenWeatherMap API key
        const baseUrl = "https://api.openweathermap.org/data/2.5/";
        let map, marker, route;
        let currentLocation = { lat: 20.5937, lng: 78.9629 }; // Default: India
        let isSidebarCollapsed = false;

        // DOM Elements
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');
        const toggleSidebarBtn = document.getElementById('toggle-sidebar');
        const mobileMenuToggle = document.getElementById('mobile-menu-toggle');
        const navItems = document.querySelectorAll('.nav-item');
        const pageTitle = document.querySelector('.page-title');
        const weatherIcon = document.getElementById('weather-icon');
        const temperature = document.getElementById('temperature');
        const weatherDesc = document.getElementById('weather-desc');
        const feelsLike = document.getElementById('feels-like');
        const humidity = document.getElementById('humidity');
        const windSpeed = document.getElementById('wind-speed');
        const pressure = document.getElementById('pressure');
        const aqiValue = document.getElementById('aqi-value');
        const aqiStatus = document.getElementById('aqi-status');
        const forecastContainer = document.getElementById('forecast-container');
        const assistantModal = document.getElementById('assistant-modal');
        const settingsModal = document.getElementById('settings-modal');
        const chatbotToggle = document.getElementById('chatbot-toggle');
        const searchBox = document.querySelector('.search-box input');

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initMap();
            getUserLocation();
            setupEventListeners();
            initChatbot();
            initSettings();
        });

        // Initialize the map
        function initMap() {
            map = L.map('map').setView([currentLocation.lat, currentLocation.lng], 5);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
            }).addTo(map);
            
            // Add click event to show detailed zones
            map.on('click', function(e) {
                showDetailedZones(e.latlng);
            });
        }

        // Show detailed zones when clicking on map
        function showDetailedZones(center) {
            // Clear existing layers
            map.eachLayer(layer => {
                if (layer instanceof L.Circle || layer instanceof L.Marker) {
                    map.removeLayer(layer);
                }
            });
            
            // Add detailed zones
            const zoneTypes = ['safe', 'warning', 'danger'];
            const zoneColors = {
                safe: '#4CAF50',
                warning: '#FF9800',
                danger: '#F44336'
            };
            
            // Add zones around the clicked point
            zoneTypes.forEach((type, i) => {
                const angle = (i * 120) * (Math.PI / 180); // 120 degrees apart
                const distance = 0.1; // ~11km
                const lat = center.lat + distance * Math.sin(angle);
                const lng = center.lng + distance * Math.cos(angle);
                
                const zone = L.circle([lat, lng], {
                    radius: 5000, // 5km radius
                    color: zoneColors[type],
                    fillColor: zoneColors[type],
                    fillOpacity: 0.3
                }).addTo(map);
                
                zone.bindPopup(`
                    <div style="text-align:center;">
                        <h3 style="margin:0;color:${zoneColors[type]}">${type.toUpperCase()} ZONE</h3>
                        <p style="margin:5px 0;">${getZoneDescription(type)}</p>
                        <small>Click outside to close</small>
                    </div>
                `).openPopup();
            });
            
            // Add marker for clicked location
            L.marker(center).addTo(map).bindPopup("Selected Location").openPopup();
        }
        
        // Get description for zone type
        function getZoneDescription(type) {
            const descriptions = {
                safe: "This area is currently safe with no weather alerts. Normal activities can continue.",
                warning: "Caution advised. Potential weather risks detected. Stay alert for updates.",
                danger: "Immediate danger present. Follow emergency procedures and evacuate if advised."
            };
            return descriptions[type] || "No information available.";
        }

        // Get user's current location
        function getUserLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        currentLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        updateWeatherData();
                        map.setView([currentLocation.lat, currentLocation.lng], 12);
                    },
                    (error) => {
                        console.error("Geolocation error:", error);
                        updateWeatherData();
                    }
                );
            } else {
                console.log("Geolocation is not supported by this browser.");
                updateWeatherData();
            }
        }

        // Update all weather data
        function updateWeatherData() {
            fetchWeatherData();
            fetchAirQuality();
            updateForecast();
            updateMapWithZones();
        }

        // Fetch weather data
        async function fetchWeatherData() {
            try {
                const response = await fetch(`${baseUrl}weather?lat=${currentLocation.lat}&lon=${currentLocation.lng}&units=metric&appid=${apikey}`);
                const data = await response.json();
                
                // Update weather information
                weatherIcon.src = `https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png`;
                temperature.textContent = `${Math.round(data.main.temp)}°C`;
                weatherDesc.textContent = data.weather[0].description;
                feelsLike.textContent = `${Math.round(data.main.feels_like)}°C`;
                humidity.textContent = `${data.main.humidity}%`;
                windSpeed.textContent = `${data.wind.speed} km/h`;
                pressure.textContent = `${data.main.pressure} hPa`;
            } catch (error) {
                console.error("Error fetching weather data:", error);
            }
        }

        // Fetch air quality data
        async function fetchAirQuality() {
            try {
                const response = await fetch(`https://api.openweathermap.org/data/2.5/air_pollution?lat=${currentLocation.lat}&lon=${currentLocation.lng}&appid=${apikey}`);
                const data = await response.json();
                const aqi = data.list[0].main.aqi;
                const status = ["Good", "Fair", "Moderate", "Poor", "Very Poor"];
                const statusColors = ["#4CAF50", "#8BC34A", "#FFC107", "#FF9800", "#F44336"];
                
                aqiValue.textContent = aqi;
                aqiStatus.textContent = `Status: ${status[aqi - 1]}`;
                aqiStatus.style.backgroundColor = statusColors[aqi - 1];
            } catch (error) {
                console.error("Error fetching air quality data:", error);
            }
        }

        // Update forecast
        async function updateForecast() {
            try {
                const response = await fetch(`${baseUrl}forecast?lat=${currentLocation.lat}&lon=${currentLocation.lng}&units=metric&appid=${apikey}`);
                const data = await response.json();
                
                forecastContainer.innerHTML = "";
                const daily = {};
                data.list.forEach(item => {
                    const date = item.dt_txt.split(" ")[0];
                    if (!daily[date]) daily[date] = item;
                });
                
                Object.values(daily).slice(0, 3).forEach(day => {
                    const date = new Date(day.dt * 1000);
                    const dayName = date.toLocaleDateString('en-US', { weekday: 'short' });
                    
                    const forecastItem = document.createElement('div');
                    forecastItem.className = 'forecast-item';
                    forecastItem.innerHTML = `
                        <div class="forecast-day">${dayName}</div>
                        <img src="https://openweathermap.org/img/wn/${day.weather[0].icon}.png" alt="${day.weather[0].description}" class="forecast-icon">
                        <div class="forecast-temp">${Math.round(day.main.temp)}°C</div>
                    `;
                    forecastContainer.appendChild(forecastItem);
                });
            } catch (error) {
                console.error("Error fetching forecast data:", error);
            }
        }

        // Update map with zones
        function updateMapWithZones() {
            if (marker) marker.remove();
            marker = L.marker([currentLocation.lat, currentLocation.lng]).addTo(map).bindPopup("Your location").openPopup();
            
            // Dummy zones for demo
            const zones = [
                { lat: currentLocation.lat + 0.05, lng: currentLocation.lng + 0.05, type: "danger", name: "Flood Risk" },
                { lat: currentLocation.lat - 0.05, lng: currentLocation.lng + 0.05, type: "safe", name: "Shelter Zone" },
                { lat: currentLocation.lat + 0.05, lng: currentLocation.lng - 0.05, type: "warning", name: "Heatwave Alert" }
            ];
            
            zones.forEach(z => {
                const color = z.type === "danger" ? "red" : z.type === "safe" ? "green" : "orange";
                L.circle([z.lat, z.lng], {
                    radius: 5000,
                    color,
                    fillColor: color,
                    fillOpacity: 0.3
                }).addTo(map).bindPopup(`<strong>${z.name}</strong><br>${z.type.toUpperCase()} ZONE`);
            });
        }

        // Setup event listeners
        function setupEventListeners() {
            // Toggle sidebar
            toggleSidebarBtn.addEventListener('click', () => {
                isSidebarCollapsed = !isSidebarCollapsed;
                sidebar.classList.toggle('sidebar-collapsed', isSidebarCollapsed);
                toggleSidebarBtn.querySelector('i').classList.toggle('fa-chevron-left');
                toggleSidebarBtn.querySelector('i').classList.toggle('fa-chevron-right');
            });

            // Mobile menu toggle
            mobileMenuToggle.addEventListener('click', () => {
                sidebar.classList.toggle('active');
            });

            // Navigation
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    navItems.forEach(nav => nav.classList.remove('active'));
                    item.classList.add('active');
                    const page = item.getAttribute('data-page');
                    pageTitle.textContent = page.charAt(0).toUpperCase() + page.slice(1);
                    
                    // Handle settings click
                    if (page === "settings") {
                        settingsModal.style.display = 'flex';
                    }
                });
            });
            
            // Search location
            searchBox.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    const location = searchBox.value.trim();
                    if (location) {
                        searchLocation(location);
                    }
                }
            });
            
            // Chatbot toggle
            chatbotToggle.addEventListener('click', () => {
                assistantModal.style.display = 'flex';
                // Clear notifications
                document.querySelector('.notification-badge').style.display = 'none';
            });
            
            // Close modals
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', function() {
                    this.closest('.modal').style.display = 'none';
                });
            });
            
            // Close modal when clicking outside
            window.addEventListener('click', (e) => {
                if (e.target.classList.contains('modal')) {
                    e.target.style.display = 'none';
                }
            });
        }

        // Initialize settings
        function initSettings() {
            // Load saved settings
            const savedSettings = JSON.parse(localStorage.getItem('weatherAppSettings')) || {};
            
            // Apply saved settings
            if (savedSettings.darkMode) {
                document.body.classList.add('dark-mode');
                document.getElementById('dark-mode-toggle').checked = true;
            }
            
            if (savedSettings.themeColor) {
                document.documentElement.style.setProperty('--primary', savedSettings.themeColor);
                document.getElementById('theme-color').value = getColorName(savedSettings.themeColor);
            }
            
            // Add event listeners for settings
            document.getElementById('dark-mode-toggle').addEventListener('change', function() {
                document.body.classList.toggle('dark-mode', this.checked);
                saveSettings();
            });
            
            document.getElementById('theme-color').addEventListener('change', function() {
                const colors = {
                    blue: '#4361ee',
                    green: '#4CAF50',
                    purple: '#9C27B0',
                    red: '#F44336'
                };
                document.documentElement.style.setProperty('--primary', colors[this.value]);
                saveSettings();
            });
            
            // Save settings function
            function saveSettings() {
                const settings = {
                    darkMode: document.getElementById('dark-mode-toggle').checked,
                    themeColor: getComputedStyle(document.documentElement).getPropertyValue('--primary').trim()
                };
                localStorage.setItem('weatherAppSettings', JSON.stringify(settings));
            }
            
            // Helper function to get color name from hex
            function getColorName(hex) {
                const colors = {
                    '#4361ee': 'blue',
                    '#4CAF50': 'green',
                    '#9C27B0': 'purple',
                    '#F44336': 'red'
                };
                return colors[hex] || 'blue';
            }
        }

        // Search for a location
        async function searchLocation(location) {
            try {
                const response = await fetch(`${baseUrl}weather?q=${location}&units=metric&appid=${apikey}`);
                const data = await response.json();
                
                if (data.cod === 200) {
                    currentLocation = {
                        lat: data.coord.lat,
                        lng: data.coord.lon
                    };
                    updateWeatherData();
                    map.setView([currentLocation.lat, currentLocation.lng], 12);
                } else {
                    alert("Location not found. Please try another city.");
                }
            } catch (error) {
                console.error("Error searching location:", error);
                alert("Error searching location. Please try again.");
            }
        }

        // Initialize chatbot
        function initChatbot() {
            const chatbotContainer = document.getElementById('chatbot-container');
            const minimizeBtn = document.getElementById('minimize-btn');
            const chatArea = document.getElementById('chat-area');
            const userInput = document.getElementById('user-input');
            const sendBtn = document.getElementById('send-btn');
            const languageBtns = document.querySelectorAll('.language-btn');
            
            // API configuration
            const OPENROUTER_API_KEY = "enter your api key";
            const MODEL = "deepseek/deepseek-chat-v3-0324:free";
            const SITE_URL = window.location.href;
            const SITE_NAME = "WeatherAI Chatbot";
            
            let isChatOpen = false;
            let currentLanguage = 'en';
            let conversationHistory = [];
            
            // Language-specific greetings
            const greetings = {
                en: "Hello! I'm your WeatherAI assistant. How can I help you today?",
                hi: "नमस्ते! मैं आपकी WeatherAI सहायक हूँ। मैं आपकी कैसे मदद कर सकती हूँ?",
                mr: "नमस्कार! मी तुमची WeatherAI सहाय्यक आहे. मी तुमची कशी मदत करू शकते?",
                ta: "வணக்கம்! நான் உங்கள் WeatherAI உதவியாளர். இன்று நான் உங்களுக்கு எப்படி உதவ முடியும்?",
                te: "హలో! నేను మీ వెదర్AI సహాయకుడిని. ఈరోజు నేను మీకు ఎలా సహాయం చేయగలను?"
            };
            
            // Language-specific placeholders
            const placeholders = {
                en: "Type your message...",
                hi: "अपना संदेश लिखें...",
                mr: "तुमचा संदेश टाइप करा...",
                ta: "உங்கள் செய்தியை தட்டச்சு செய்யவும்...",
                te: "మీ సందేశాన్ని టైప్ చేయండి..."
            };
            
            // System prompts for each language
            const systemPrompts = {
                en: `You are a helpful AI assistant for WeatherAI that responds in English. Be friendly, concise, and helpful in your responses. 
                You can provide weather information, forecasts, and disaster management tips. 
                For emergency situations in India, provide relevant contacts and advice.`,
                hi: `आप WeatherAI के लिए एक सहायक AI सहायक हैं जो हिंदी में जवाब देते हैं। अपने उत्तरों में मित्रतापूर्ण, संक्षिप्त और सहायक बनें। 
                आप मौसम की जानकारी, पूर्वानुमान और आपदा प्रबंधन युक्तियाँ प्रदान कर सकते हैं। 
                भारत में आपातकालीन स्थितियों के लिए, प्रासंगिक संपर्क और सलाह प्रदान करें।`,
                mr: `तुम एक उपयुक्त AI सहाय्यक आहात जो WeatherAI साठी मराठीत उत्तर देतो. तुमच्या उत्तरात मैत्रीपूर्ण, संक्षिप्त आणि उपयुक्त व्हा. 
                तुम्ही हवामान माहिती, अंदाज आणि आपत्ती व्यवस्थापन टिपा देऊ शकता. 
                भारतातील आणीबाणीच्या परिस्थितीसाठी, संबंधित संपर्क आणि सल्ला द्या.`,
                ta: `நீங்கள் WeatherAIக்கான ஒரு உதவியாக AI உதவியாளர், ஆங்கிலத்தில் பதிலளிக்கிறீர்கள். உங்கள் பதில்களில் நட்பு, சுருக்கமான மற்றும் உதவிகரமாக இருங்கள். 
                வானிலை தகவல், முன்னறிவிப்புகள் மற்றும் பேரிடர் மேலாண்மை உதவிக்குறிப்புகளை வழங்கலாம். 
                இந்தியாவில் அவசரகால சூழ்நிலைகளுக்கு, தொடர்புடைய தொடர்புகள் மற்றும் ஆலோசனைகளை வழங்கவும்.`,
                te: `మీరు వెదర్AIకి సహాయక AI అసిస్టెంట్, ఇంగ్లీషులో ప్రత్యుత్తరం ఇస్తారు. మీ స్పందనలలో స్నేహపూర్వకంగా, సంక్షిప్తంగా మరియు సహాయకరంగా ఉండండి. 
                వాతావరణ సమాచారం, ఫోర్కాస్ట్లు మరియు విపత్తు నిర్వహణ చిట్కాలను అందించవచ్చు. 
                భారతదేశంలో అత్యవసర పరిస్థితులకు, సంబంధిత సంప్రదింపులు మరియు సలహాలను అందించండి.`
            };
            
            // Emergency contacts for India
            const emergencyContacts = {
                en: {
                    ambulance: "Ambulance: 108 or 102",
                    fire: "Fire Brigade: 101",
                    police: "Police: 100",
                    disaster: "Disaster Management: 1078",
                    women: "Women Helpline: 1091",
                    child: "Child Helpline: 1098"
                },
                hi: {
                    ambulance: "एम्बुलेंस: 108 या 102",
                    fire: "फायर ब्रिगेड: 101",
                    police: "पुलिस: 100",
                    disaster: "आपदा प्रबंधन: 1078",
                    women: "महिला हेल्पलाइन: 1091",
                    child: "चाइल्ड हेल्पलाइन: 1098"
                },
                mr: {
                    ambulance: "रुग्णवाहिका: 108 किंवा 102",
                    fire: "अग्निशमन दल: 101",
                    police: "पोलीस: 100",
                    disaster: "आपत्ती व्यवस्थापन: 1078",
                    women: "महिला हेल्पलाइन: 1091",
                    child: "बाल हेल्पलाइन: 1098"
                },
                ta: {
                    ambulance: "ஆம்புலன்ஸ்: 108 அல்லது 102",
                    fire: "தீயணைப்பு படை: 101",
                    police: "காவல்: 100",
                    disaster: "பேரிடர் மேலாண்மை: 1078",
                    women: "பெண்கள் உதவி மையம்: 1091",
                    child: "குழந்தை உதவி மையம்: 1098"
                },
                te: {
                    ambulance: "ఆంబ్యులెన్స్: 108 లేదా 102",
                    fire: "అగ్నిమాపక దళం: 101",
                    police: "పోలీసు: 100",
                    disaster: "విపత్తు నిర్వహణ: 1078",
                    women: "మహిళల హెల్ప్ లైన్: 1091",
                    child: "చైల్డ్ హెల్ప్ లైన్: 1098"
                }
            };
            
            // Set initial language
            setLanguage('en');
            
            // Set language
            function setLanguage(lang) {
                currentLanguage = lang;
                userInput.placeholder = placeholders[lang];
                
                // Update active button
                languageBtns.forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.lang === lang);
                });
                
                // Reset conversation with new system prompt
                conversationHistory = [
                    {
                        role: "system",
                        content: systemPrompts[lang]
                    }
                ];
                
                // Clear chat area and add new greeting
                chatArea.innerHTML = '';
                addMessage(greetings[lang], false);
                conversationHistory.push({
                    role: "assistant",
                    content: greetings[lang]
                });
            }
            
            // Language button click handlers
            languageBtns.forEach(btn => {
                btn.addEventListener('click', () => {
                    setLanguage(btn.dataset.lang);
                });
            });
            
            // Add message to chat area
            function addMessage(text, isUser) {
                const messageDiv = document.createElement('div');
                messageDiv.classList.add('message');
                messageDiv.classList.add(isUser ? 'user-message' : 'bot-message');
                
                const now = new Date();
                const timeString = now.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                
                messageDiv.innerHTML = `
                    <div class="message-text">${text}</div>
                    <div class="message-time">${timeString}</div>
                `;
                
                chatArea.appendChild(messageDiv);
                chatArea.scrollTop = chatArea.scrollHeight;
            }
            
            // Show typing indicator
            function showTypingIndicator() {
                const typingDiv = document.createElement('div');
                typingDiv.classList.add('typing-indicator');
                typingDiv.id = 'typing-indicator';
                
                const typingText = document.createElement('span');
                typingText.classList.add('typing-text');
                
                // Language-specific typing text
                const typingTexts = {
                    en: "AI is typing",
                    hi: "AI टाइप कर रहा है",
                    mr: "AI टाइप करत आहे",
                    ta: "AI தட்டச்சு செய்கிறது",
                    te: "AI టైప్ చేస్తోంది"
                };
                
                typingText.textContent = typingTexts[currentLanguage];
                typingDiv.appendChild(typingText);
                
                for (let i = 0; i < 3; i++) {
                    const dot = document.createElement('div');
                    dot.classList.add('typing-dot');
                    typingDiv.appendChild(dot);
                }
                
                chatArea.appendChild(typingDiv);
                chatArea.scrollTop = chatArea.scrollHeight;
            }
            
            // Hide typing indicator
            function hideTypingIndicator() {
                const typingIndicator = document.getElementById('typing-indicator');
                if (typingIndicator) {
                    typingIndicator.remove();
                }
            }
            
            // Get response from OpenRouter API
            async function getAIResponse(userMessage) {
                // Add user message to conversation history
                conversationHistory.push({
                    role: "user",
                    content: userMessage
                });
                
                showTypingIndicator();
                sendBtn.disabled = true;
                userInput.disabled = true;
                
                try {
                    const response = await fetch("https://openrouter.ai/api/v1/chat/completions", {
                        method: "POST",
                        headers: {
                            "Authorization": `Bearer ${OPENROUTER_API_KEY}`,
                            "HTTP-Referer": SITE_URL,
                            "X-Title": SITE_NAME,
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({
                            "model": MODEL,
                            "messages": conversationHistory
                        })
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error?.message || `API request failed with status ${response.status}`);
                    }
                    
                    const data = await response.json();
                    const aiResponse = data.choices[0].message.content;
                    
                    // Add AI response to conversation history
                    conversationHistory.push({
                        role: "assistant",
                        content: aiResponse
                    });
                    
                    return aiResponse;
                } catch (error) {
                    console.error("Error fetching AI response:", error);
                    
                    // Language-specific error messages
                    const errorMessages = {
                        en: "Sorry, I encountered an error. Please try again.",
                        hi: "क्षमा करें, मुझे एक त्रुटि मिली। कृपया पुनः प्रयास करें।",
                        mr: "माफ करा, मला एक त्रुटी आली. कृपया पुन्हा प्रयत्न करा.",
                        ta: "மன்னிக்கவும், நான் ஒரு பிழையை சந்தித்தேன். தயவு செய்து மீண்டும் முயற்சிக்கவும்.",
                        te: "క్షమించండి, నేను ఒక లోపాన్ని ఎదుర్కొన్నాను. దయచేసి మళ్లీ ప్రయత్నించండి."
                    };
                    
                    return errorMessages[currentLanguage];
                } finally {
                    hideTypingIndicator();
                    sendBtn.disabled = false;
                    userInput.disabled = false;
                    userInput.focus();
                }
            }
            
            // Handle user input
            async function handleUserInput() {
                const message = userInput.value.trim();
                if (message) {
                    addMessage(message, true);
                    userInput.value = '';
                    
                    // Check for emergency keywords
                    const emergencyKeywords = ['emergency', 'help', 'ambulance', 'fire', 'police', 'disaster', 
                                            'आपातकाल', 'मदद', 'एम्बुलेंस', 'अग्नि', 'पुलिस', 'आपदा',
                                            'आणीबाणी', 'मदत', 'रुग्णवाहिका', 'आग', 'पोलीस', 'आपत्ती',
                                            'அவசர', 'உதவி', 'ஆம்புலன்ஸ்', 'தீ', 'காவல்', 'பேரிடர்',
                                            'అత్యవసర', 'సహాయం', 'ఆంబ్యులెన్స్', 'అగ్ని', 'పోలీసు', 'విపత్తు'];
                    
                    const isEmergency = emergencyKeywords.some(keyword => 
                        message.toLowerCase().includes(keyword.toLowerCase())
                    );
                    
                    if (isEmergency) {
                        // Show emergency contacts
                        const contacts = emergencyContacts[currentLanguage];
                        let emergencyMessage = "";
                        
                        for (const [key, value] of Object.entries(contacts)) {
                            emergencyMessage += `${value}\n`;
                        }
                        
                        emergencyMessage += "\n" + (currentLanguage === 'en' ? 
                            "Please call the appropriate number for your emergency. Stay safe!" :
                            currentLanguage === 'hi' ? "कृपया अपनी आपात स्थिति के लिए उपयुक्त नंबर पर कॉल करें। सुरक्षित रहें!" :
                            currentLanguage === 'mr' ? "कृपया तुमच्या आणीबाणीसाठी योग्य नंबरवर कॉल करा. सुरक्षित रहा!" :
                            currentLanguage === 'ta' ? "உங்கள் அவசரநிலைக்கு பொருத்தமான எண்ணை அழைக்கவும். பாதுகாப்பாக இருங்கள்!" :
                            "దయచేసి మీ అత్యవసర స్థితికి తగిన నంబర్‌కు కాల్ చేయండి. సురక్షితంగా ఉండండి!");
                        
                        addMessage(emergencyMessage, false);
                        conversationHistory.push({
                            role: "assistant",
                            content: emergencyMessage
                        });
                    } else {
                        const aiResponse = await getAIResponse(message);
                        addMessage(aiResponse, false);
                    }
                }
            }
            
            sendBtn.addEventListener('click', handleUserInput);
            userInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleUserInput();
                }
            });
        }
    </script>
</body>

</html>
